<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>LiveRoom.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ChatBoard.html">ChatBoard</a></li>
                                <li><a href="../classes/ChatBoardForRecord.html">ChatBoardForRecord</a></li>
                                <li><a href="../classes/CodeEditor.html">CodeEditor</a></li>
                                <li><a href="../classes/FileDisplay.html">FileDisplay</a></li>
                                <li><a href="../classes/FileDisplayForRecord.html">FileDisplayForRecord</a></li>
                                <li><a href="../classes/HomePage.html">HomePage</a></li>
                                <li><a href="../classes/HomePageHeader.html">HomePageHeader</a></li>
                                <li><a href="../classes/LivePage.html">LivePage</a></li>
                                <li><a href="../classes/LivePicture.html">LivePicture</a></li>
                                <li><a href="../classes/LiveRoom.html">LiveRoom</a></li>
                                <li><a href="../classes/Login.html">Login</a></li>
                                <li><a href="../classes/PageFooter.html">PageFooter</a></li>
                                <li><a href="../classes/RecordPage.html">RecordPage</a></li>
                                <li><a href="../classes/RecordPicture.html">RecordPicture</a></li>
                                <li><a href="../classes/RecordRoom.html">RecordRoom</a></li>
                                <li><a href="../classes/Reset.html">Reset</a></li>
                                <li><a href="../classes/SignUp.html">SignUp</a></li>
                                <li><a href="../classes/TeachingTools.html">TeachingTools</a></li>
                                <li><a href="../classes/VideoDisplay.html">VideoDisplay</a></li>
                                <li><a href="../classes/WhiteBoard.html">WhiteBoard</a></li>
                                <li><a href="../classes/WhiteBoardForRecord.html">WhiteBoardForRecord</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ChatBoard.html">ChatBoard</a></li>
                                <li><a href="../modules/ChatBoardForRecord.html">ChatBoardForRecord</a></li>
                                <li><a href="../modules/CodeEditor.html">CodeEditor</a></li>
                                <li><a href="../modules/FileDisplay.html">FileDisplay</a></li>
                                <li><a href="../modules/FileDisplayForRecord.html">FileDisplayForRecord</a></li>
                                <li><a href="../modules/HomePage.html">HomePage</a></li>
                                <li><a href="../modules/HomePageHeader.html">HomePageHeader</a></li>
                                <li><a href="../modules/LivePage.html">LivePage</a></li>
                                <li><a href="../modules/LivePicture.html">LivePicture</a></li>
                                <li><a href="../modules/LiveRoom.html">LiveRoom</a></li>
                                <li><a href="../modules/Login.html">Login</a></li>
                                <li><a href="../modules/PageFooter.html">PageFooter</a></li>
                                <li><a href="../modules/RecordPage.html">RecordPage</a></li>
                                <li><a href="../modules/RecordPicture.html">RecordPicture</a></li>
                                <li><a href="../modules/RecordRoom.html">RecordRoom</a></li>
                                <li><a href="../modules/Reset.html">Reset</a></li>
                                <li><a href="../modules/SignUp.html">SignUp</a></li>
                                <li><a href="../modules/TeachingTools.html">TeachingTools</a></li>
                                <li><a href="../modules/VideoDisplay.html">VideoDisplay</a></li>
                                <li><a href="../modules/WhiteBoard.html">WhiteBoard</a></li>
                                <li><a href="../modules/WhiteBoardForRecord.html">WhiteBoardForRecord</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: LiveRoom.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;template&gt;
    &lt;div id=&quot;bg&quot;&gt;
        &lt;div class=&quot;live-room&quot;&gt;
            &lt;div class=&quot;header&quot;&gt;
                &lt;home-page-header&gt;&lt;/home-page-header&gt;
            &lt;/div&gt;
            &lt;div class=&quot;navigation&quot;&gt;
                &lt;div class=&quot;welcome&quot;&gt;
                    &lt;Icon type=&quot;university&quot;&gt;&lt;/Icon&gt;
                    &lt;label&gt;欢迎进入直播间 !&lt;/label&gt;
                &lt;/div&gt;
                &lt;div class=&quot;navigation-center&quot;&gt;
                    &lt;label class=&quot;information&quot;&gt;老师姓名：{{ this.teacherName }}&lt;/label&gt;
                    &lt;label class=&quot;information&quot;&gt;房间ID:{{ this.roomId }}&lt;/label&gt;
                    &lt;label class=&quot;information&quot;&gt;房间名：{{ this.roomName }}&lt;/label&gt;
                    &lt;label class=&quot;information&quot;&gt;在线人数：{{ this.studentNum }}&lt;/label&gt;
                &lt;/div&gt;
                &lt;div class=&quot;navigation-right&quot;&gt;
                    &lt;template v-if=&quot;this.teacherName === this.username&quot;&gt;
                        &lt;Button @click=&quot;startLive&quot; type=&quot;primary&quot; shape=&quot;circle&quot; size=&quot;small&quot;&gt;开始直播&lt;/Button&gt;
                    &lt;/template&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;layout-header&quot; id=&quot;teaching&quot;&gt;
                &lt;div id=&quot;left-container&quot;&gt;
                    &lt;keep-alive&gt;
                        &lt;component :is=&quot;this.leftComponent&quot; :roomId=&quot;this.roomId&quot; :teacherName=&quot;this.teacherName&quot; :username=&quot;this.username&quot; :teaching-tools-width=&quot;this.whiteBoardWidth&quot; :teaching-tools-height=&quot;this.whiteBoardHeight&quot;&gt;&lt;/component&gt;
                    &lt;/keep-alive&gt;
                &lt;/div&gt;
                &lt;div id=&quot;buttons-panel&quot;&gt;
                    &lt;template v-if=&quot;this.hidden === true&quot;&gt;
                        &lt;Tooltip content=&quot;弹出右边窗口&quot; placement=&quot;right-start&quot;&gt;
                            &lt;Button id=&quot;pop-up-button&quot; type=&quot;ghost&quot; @click=&quot;popUp&quot;&gt;
                                &lt;Icon type=&quot;ios-redo&quot;&gt;&lt;/Icon&gt;
                            &lt;/Button&gt;
                        &lt;/Tooltip&gt;
                    &lt;/template&gt;
                    &lt;template v-else&gt;
                        &lt;Tooltip content=&quot;切换位置&quot; placement=&quot;right-start&quot;&gt;
                            &lt;Button id=&quot;swap-button&quot; type=&quot;ghost&quot; @click=&quot;swap&quot;&gt;
                                &lt;Icon type=&quot;arrow-swap&quot;&gt;&lt;/Icon&gt;
                            &lt;/Button&gt;
                        &lt;/Tooltip&gt;&lt;br&gt;
                        &lt;Tooltip content=&quot;隐藏右边窗口&quot; placement=&quot;right-start&quot;&gt;
                            &lt;Button id=&quot;hide-button&quot; type=&quot;ghost&quot; @click=&quot;hide&quot;&gt;
                                &lt;Icon type=&quot;ios-undo&quot;&gt;&lt;/Icon&gt;
                            &lt;/Button&gt;
                        &lt;/Tooltip&gt;
                    &lt;/template&gt;
                &lt;/div&gt;
                &lt;div id=&quot;right-container&quot;&gt;
                    &lt;div id=&quot;right-up-container&quot;&gt;
                        &lt;keep-alive&gt;
                            &lt;component :is=&quot;this.rightComponent&quot; :roomId=&quot;this.roomId&quot; :teacherName=&quot;this.teacherName&quot; :username=&quot;this.username&quot; :teaching-tools-width=&quot;this.whiteBoardWidth&quot; :teaching-tools-height=&quot;this.whiteBoardHeight&quot;&gt;&lt;/component&gt;
                        &lt;/keep-alive&gt;
                    &lt;/div&gt;
                    &lt;div id=&quot;chatroom&quot;&gt;
                        &lt;chat-board v-on:stuNum=&quot;getNum&quot; :roomId=&quot;this.roomId&quot; :teacherName=&quot;this.teacherName&quot; :username=&quot;this.username&quot; :above-hidden=&quot;this.hidden&quot;&gt;&lt;/chat-board&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;page-footer&gt;&lt;/page-footer&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script src=&quot;/socket.io/socket.io.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
/**
 * 直播间页面
 *
 * @module LiveRoom
 * @class LiveRoom
 */
import * as io from &#x27;socket.io-client&#x27;
import HomePageHeader from &#x27;./HomePageHeader&#x27;
import PageFooter from &#x27;./PageFooter&#x27;
import VideoDisplay from &#x27;./VideoDisplay&#x27;
import ChatBoard from &#x27;./ChatBoard&#x27;
import TeachingTools from &#x27;./TeachingTools&#x27;

export default {
    name: &#x27;live-room&#x27;,
    components: {
        HomePageHeader,
        PageFooter,
        ChatBoard,
        VideoDisplay,
        TeachingTools
    },
    data: function () {
        return {
            /**
             * 房间ID
             *
             * @attribute roomId
             * @type Number
             * @default -1
             */
            roomId: -1,
            /**
             * 房间名称
             *
             * @attribute roomName
             * @type String
             * @default &#x27;&#x27;
             */
            roomName: &#x27;&#x27;,
            /**
             * 老师名字
             *
             * @attribute teacherName
             * @type String
             * @default &#x27;&#x27;
             */
            teacherName: &#x27;&#x27;,
            /**
             * 在线人数
             *
             * @attribute studentNum
             * @type String
             * @default &#x27;&#x27;
             */
            studentNum: &#x27;&#x27;,
            /**
             * 用户名字
             *
             * @attribute username
             * @type String
             * @default &#x27;&#x27;
             */
            username: &#x27;&#x27;,
            /**
             * 教学区域div的宽
             *
             * @attribute teachingWidth
             * @type Number
             * @default 100
             */
            teachingWidth: 100,
            /**
             * 教学区域div的高
             *
             * @attribute teachingHeight
             * @type Number
             * @default 100
             */
            teachingHeight: 100,
            /**
             * 白板区域div的宽
             *
             * @attribute whiteBoardWidth
             * @type Number
             * @default 100
             */
            whiteBoardWidth: 100,
            /**
             * 白板区域div的高
             *
             * @attribute whiteBoardHeight
             * @type Number
             * @default 100
             */
            whiteBoardHeight: 100,
            /**
             * 表示左边的子组件
             *
             * @attribute leftComponent
             * @type String
             * @default &#x27;TeachingTools&#x27;
             */
            leftComponent: &#x27;TeachingTools&#x27;,
            /**
             * 表示右边的子组件
             *
             * @attribute rightComponent
             * @type String
             * @default &#x27;VideoDisplay&#x27;
             */
            rightComponent: &#x27;VideoDisplay&#x27;,
            /**
             * 表示是否隐藏视频区域
             *
             * @attribute hidden
             * @type Boolean
             * @default false
             */
            hidden: false,
            /**
             * 表示客户端，监听服务器传来的消息
             *
             * @attribute socket
             * @type Object
             * @default &#x27;&#x27;
             */
            socket: &#x27;&#x27;
        }
    },
    /**
     * created函数，初始化相关数据，客户端发送&#x27;joinRoom&#x27;消息
     *
     * @method created
     */
    created: function () {
        this.roomId = this.$route.params.id
        this.socket = io.connect(&#x27;http://localhost:9000&#x27;)
        this.socket.emit(&#x27;joinRoom&#x27;, this.roomId)
        this.getRoomInfo()
        this.getUsername()
        window.setInterval(this.changeNum, 5000)
    },
    /**
     * mounted函数，初始化教学区域和白板区域的长和高，
     * 并监测窗口大小的改变，实时变化相应参数
     *
     * @method mounted
     */
    mounted: function () {
        let self = this
        self.teachingWidth = document.getElementById(&#x27;teaching&#x27;).clientWidth
        self.teachingHeight = document.getElementById(&#x27;teaching&#x27;).clientHeight
        self.whiteBoardWidth = self.teachingWidth * 0.68 - 77
        self.whiteBoardHeight = self.teachingHeight - 35
        window.onresize = function () {
            self.teachingWidth = document.getElementById(&#x27;teaching&#x27;).clientWidth
            self.teachingHeight = document.getElementById(&#x27;teaching&#x27;).clientHeight
            self.whiteBoardWidth = self.teachingWidth * 0.68 - 77
            self.whiteBoardHeight = self.teachingHeight - 35
        }
    },
    methods: {
        /**
         * 开始直播，发送&#x27;startLive&#x27;消息
         *
         * @method startLive
         */
        startLive: function () {
            this.socket.emit(&#x27;startLive&#x27;, this.roomId)
        },
        /**
         * 隐藏视频区域，改变相关div的大小
         *
         * @method hide
         */
        hide: function () {
            let rightContent = document.getElementById(&#x27;right-up-container&#x27;)
            rightContent.style.display = &#x27;none&#x27;
            this.hidden = true
            document.getElementById(&#x27;chatroom&#x27;).style.marginTop = &#x27;0&#x27;
            document.getElementById(&#x27;chatroom&#x27;).style.height = &#x27;100%&#x27;
        },
        /**
         * 弹出右边窗口
         *
         * @method popUp
         */
        popUp: function () {
            let rightContent = document.getElementById(&#x27;right-up-container&#x27;)
            rightContent.style.display = &#x27;block&#x27;
            this.hidden = false
            document.getElementById(&#x27;chatroom&#x27;).style.marginTop = &#x27;2%&#x27;
            document.getElementById(&#x27;chatroom&#x27;).style.height = &#x27;56%&#x27;
        },
        /**
         * 左右子组件交换位置
         *
         * @method swap
         */
        swap: function () {
            let tmp = this.leftComponent
            this.leftComponent = this.rightComponent
            this.rightComponent = tmp
        },
        /**
         * 更新学生数量
         *
         * @method changeNum
         */
        changeNum: function () {
            if (this.username === this.teacherName) {
                fetch(&#x27;/changeNum/&#x27;, {
                    method: &#x27;post&#x27;,
                    mode: &#x27;cors&#x27;,
                    headers: {
                        &#x27;Content-Type&#x27;: &#x27;application/json, text/plain, */*&#x27;,
                        &#x27;Accept&#x27;: &#x27;application/json&#x27;
                    },
                    body: JSON.stringify({
                        &#x27;studentNum&#x27;: this.studentNum,
                        &#x27;roomId&#x27;: this.roomId
                    })
                }).then((response) =&gt; response.json()).then((obj) =&gt; { })
            }
        },
        /**
         * 获取学生数量
         *
         * @method getNum
         */
        getNum: function (count) {
            this.studentNum = count
        },
        /**
         * 获取房间信息
         *
         * @method getRoomInfo
         */
        getRoomInfo: function () {
            fetch(&#x27;/getRoomInfo/&#x27;, {
                method: &#x27;post&#x27;,
                mode: &#x27;cors&#x27;,
                headers: {
                    &#x27;Content-Type&#x27;: &#x27;application/json, text/plain, */*&#x27;,
                    &#x27;Accept&#x27;: &#x27;application/json&#x27;
                },
                body: JSON.stringify({
                    &#x27;roomID&#x27;: this.roomId
                })
            }).then((response) =&gt; response.json()).then((obj) =&gt; {
                this.roomName = obj.roomName
                this.studentNum = obj.stuNum
                this.teacherName = obj.teacherName
            })
        },
        /**
         * 获取用户名称
         *
         * @method getUsername
         */
        getUsername: function () {
            let arrCookies = document.cookie.split(&#x27;;&#x27;)
            let account = &#x27;&#x27;
            for (let i = 0; i &lt; arrCookies.length; i++) {
                let arrStr = arrCookies[i].split(&#x27;=&#x27;)
                if (arrStr[0].replace(/(^\s*)|(\s*$)/g, &#x27;&#x27;) === &#x27;userAccount&#x27;) {
                    account = arrStr[1].replace(/(^\s*)|(\s*$)/g, &#x27;&#x27;)
                }
            }
            if (account !== &#x27;&#x27;) {
                fetch(&#x27;/getName/&#x27;, {
                    method: &#x27;post&#x27;,
                    mode: &#x27;cors&#x27;,
                    headers: {
                        &#x27;Content-Type&#x27;: &#x27;application/json, text/plain, */*&#x27;,
                        &#x27;Accept&#x27;: &#x27;application/json&#x27;
                    },
                    body: JSON.stringify({ &#x27;account&#x27;: account })
                }).then((response) =&gt; response.json()).then((obj) =&gt; {
                    this.username = obj.name
                })
            }
        }
    }
}
&lt;/script&gt;

&lt;style scoped&gt;
#bg {
    background: #f5f7f9;
}

.live-room {
    background: #f5f7f9;
    position: relative;
    border-radius: 5px;
    overflow: hidden;
    width: 177vmin;
    height: 100vmin;
    margin-left: auto;
    margin-right: auto;
}

.header {
    height: 60px;
    width: 100%;
    font-size: 40px;
    position: fixed;
    left: 0;
    z-index: 50;
}

.navigation {
    background: #efefef;
    padding: 8px 10px;
    overflow: hidden;
    display: flex;
    position: fixed;
    left: 0;
    top: 60px;
    width: 100%;
    font-size: 15px;
}

.navigation-center {
    margin: 0 auto;
    font-size: 15px;
}

.navigation-right {
    margin-right: 15px;
    width: 64px;
    font-size: 15px;
}

.information {
    margin: 0 auto;
}

.layout-header {
    width: 78%;
    height: 78%;
    min-width: 800px;
    display: flex;
    margin-left: auto;
    margin-right: auto;
    margin-top: 110px;
}

#left-container {
    height: 100%;
    width: 68%;
    text-align: left;
    overflow: hidden;
}

#right-container {
    width: 30%;
    height: 100%;
}

#right-up-container {
    width: 100%;
}

#chatroom {
    margin-top: 2%;
    height: 56%;
    width: 100%;
}

#swap-button,
#pop-up-button,
#hide-button {
    height: 41px;
    border: none;
}
&lt;/style&gt;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
